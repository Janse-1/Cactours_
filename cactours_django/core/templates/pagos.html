{% extends 'base.html' %}
{% load static %}

{% block content %}
<style>
    html, body {
        height: 150%;
        margin: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #056b7c;
    }

    .payment-container {
        max-width: 500px;
        padding: 90px;
        background-color: rgba(0, 0, 0, 0.8);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        border-radius: 10px;
        text-align: center;
        color: white;
    }

    .form-group {
        margin-bottom: 20px;
        text-align: left;
    }

    .form-group label {
        display: block;
        margin-bottom: 5px;
        color: white;
    }

    .form-group input, 
    .form-group select, 
    .form-group textarea {
        width: 120%;
        padding: 5px;
        border-radius: 5px;
        border: 1px solid #ccc;
    }

    .cta-button {
        padding: 10px 20px;
        background-color: #28a745;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .cta-button:hover {
        background-color: #218838;
    }
</style>

<div class="payment-container">
    <h2>Formulario de Pago</h2>

    <form method="POST" action="/confirmar_pago/" class="payment-form">
        {% csrf_token %}

        <div class="form-group">
            <label for="tour">Tour Seleccionado:</label>
            <select id="tour" name="tour" required onchange="actualizarPrecio()">
                <option value="playa">Tour a la Playa</option>
                <option value="gastronomico">Tour Gastronómico</option>
                <option value="cultural">Tour Cultural</option>
                <option value="departamental">Tour Departamental</option>
            </select>
        </div>

        <div class="form-group">
            <label for="num_personas">Número de Personas:</label>
            <input type="number" id="num_personas" name="num_personas" min="1" required onchange="actualizarPrecio()">
        </div>

        <div class="form-group">
            <label for="precio_total">Precio Total:</label>
            <p id="precio_total">$0</p>
        </div>

        <div class="form-group">
            <label for="fecha">Fecha del Tour:</label>
            <input type="date" id="fecha" name="fecha" required>
        </div>

        <div class="form-group">
            <label for="hora">Hora de inicio:</label>
            <input type="time" id="hora" name="hora" required>
        </div>

        <div class="form-group">
            <label for="banco">Medio de Pago:</label>
            <select id="banco" name="banco" required>
                <option value="Banco1">Banco Popular</option>
                <option value="Banco2">Bancolombia</option>
                <option value="Banco3">Davivienda</option>
                <option value="Banco4">BBVA</option>
                <option value="Banco5">Nequi</option>
                <option value="Banco6">Otro</option>
            </select>
        </div>

        <div class="form-group">
            <label for="comments">Comentarios o Preferencias Especiales:</label>
            <textarea id="comments" name="comments" rows="4"></textarea>
        </div>

        <button type="button" class="cta-button" onclick="redirigirPago()">Confirmar Pago</button>
    </form>

    <!-- Script para calcular el precio dinámico -->
    <script>
        // Precios base por tipo de tour
        const preciosBase = {
            playa: 150000,
            gastronomico: 180000,
            cultural: 180000,
            departamental: 250000
        };

        // Función para actualizar el precio total
        function actualizarPrecio() {
            const tourSeleccionado = document.getElementById('tour').value;
            const numPersonas = document.getElementById('num_personas').value || 1;
            
            // Calcular precio total
            const precioBase = preciosBase[tourSeleccionado];
            const precioTotal = precioBase * numPersonas;

            // Mostrar precio total
            document.getElementById('precio_total').textContent = $${precioTotal.toLocaleString()};
        }

         // Función para redirigir al usuario al banco seleccionado
         function redirigirPago() {
            const bancoSeleccionado = document.getElementById('banco').value;
            let urlBanco;

            switch (bancoSeleccionado) {
                case 'Banco1':
                    urlBanco = "https://www.bancopopular.com.co";  // URL del Banco Popular
                    break;
                case 'Banco2':
                    urlBanco = "https://www.bancolombia.com";  // URL de Bancolombia
                    break;
                case 'Banco3':
                    urlBanco = "https://www.davivienda.com";  // URL de Davivienda
                    break;
                case 'Banco4':
                    urlBanco = "https://www.bbva.com.co";  // URL de BBVA
                    break;
                case 'Banco5':
                    urlBanco = "https://www.nequi.com.co";  // URL de Nequi
                    break;
                case 'Banco6':
                    urlBanco = "https://www.otro-banco.com";  // URL de Otro banco
                    break;
                default:
                    alert("Por favor, selecciona un banco.");
                    return;
            }

            // Redirigir al banco seleccionado
            window.location.href = urlBanco;
        }
    </script>
</div>

{% endblock %}